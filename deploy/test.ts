import { ethers} from "ethers";
import { Wallet, utils, Contract, Provider} from 'zksync-web3';
import { HardhatRuntimeEnvironment } from 'hardhat/types';
import { Deployer } from '@matterlabs/hardhat-zksync-deploy';
import { rich_wallet } from "./utils/rich-wallet"
import { toBN } from "./utils/helper";

// Deploy function
export default async function deployAll (hre: HardhatRuntimeEnvironment) {
    const provider = new Provider("http://localhost:3050", 270);
    const wallet = new Wallet(rich_wallet[0].privateKey, provider);
    const deployer = new Deployer(hre, wallet);
    
   // Deploy AccountFactory
    const accountArtifact = await deployer.loadArtifact("Account");

    const account = new Contract(
        "0x6B6C200cBfFA985cE0CA357f3CFb07959CB8a7b7", 
        accountArtifact.abi,
        wallet
        )

    // // const coordinates0 = await account.callStatic.Q(0)
    // // const coordinates1 = await account.callStatic.Q(1)
    // // console.log(`coordinates 0: "${coordinates0}",`)
    // // console.log(`coordinates 1: "${coordinates1}",`)


    // const array: Buffer = new Buffer(Buffer.from("0x00000000000000000000000000000000000000000000000000000000000000e00100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000024ab4fa076c84db7ed8ef48f524e6a412e274b1eafb0f851f40066369d78df95e5e434909da0ef57c0bbe23f0a4bf7eb2331d7ffef5f83c249478aa0944a195322000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a2239623134623066612d393866312d346465352d623538612d396133313261306665623234222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303030222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000002439623134623066612d393866312d346465352d623538612d39613331326130666562323400000000000000000000000000000000000000000000000000000000"))
    // console.log("array", array)

    // const sig = await account.decodeSignature(array)

    // console.log("sig: ", sig)

    const hash = await account.callStatic.checkPosition(ethers.utils.arrayify(
        "0xf6c19ebd96ff1a3446a6a75317baba368c6351fb6e776d00f3cd69e476a4fce900000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000024579158970000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000"
    ))

   console.log("hash: ", hash)

   //console.log("hash w/ 0x: ", hash.slice(2))
}



